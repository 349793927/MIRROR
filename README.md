
---

# ğŸª MIRRORï¼šManifold Ideal Reference ReconstructOR for Generalizable AI-Generated Image Detection  
**ç”¨äºé€šç”¨ AI ç”Ÿæˆå›¾åƒæ£€æµ‹çš„æµå½¢ç†æƒ³å‚è€ƒé‡å»ºå™¨**

**MIRROR** æ˜¯ä¸€ç§ä¸“ä¸º **AI ç”Ÿæˆå›¾åƒï¼ˆAIGIï¼‰æ£€æµ‹** è®¾è®¡çš„åˆ›æ–°æ¡†æ¶ã€‚ä¸åŒäºä¼ ç»Ÿçš„äºŒåˆ†ç±»æ£€æµ‹èŒƒå¼ï¼ŒMIRROR é‡‡ç”¨äº†ä¸€æ¡å…¨æ–°çš„æ€è·¯ï¼š  
é€šè¿‡åœ¨**å†»ç»“çš„ç°å®å…ˆéªŒå­˜å‚¨åº“ï¼ˆMemory Bankï¼‰**ä¸­é‡å»ºç†æƒ³çš„â€œçœŸå®å‚è€ƒâ€ï¼Œå¹¶åˆ†æ**åŸå§‹å›¾åƒç‰¹å¾**ä¸**é‡å»ºç‰¹å¾**ä¹‹é—´çš„ç»†å¾®å·®å¼‚ï¼Œä»è€Œç²¾å‡†æ•æ‰ AI ç”Ÿæˆå†…å®¹æ‰€ç•™ä¸‹çš„éšè”½ç—•è¿¹ã€‚

---

## âœ¨ æ ¸å¿ƒäº®ç‚¹

- **ğŸ† SOTA æ€§èƒ½**ï¼šåœ¨ **AIGCDetectã€Genimageã€UnivFDã€Chameleon** ç­‰ **14 ä¸ªä¸»æµåŸºå‡†æµ‹è¯•** ä¸Šåˆ·æ–°æˆ–åŒ¹é…å½“å‰æœ€ä¼˜ç»“æœã€‚  
- **ğŸ§  å¼ºå¤§æ¨¡å‹åº•åº§**ï¼šé‡‡ç”¨ **DINOv3** ä½œä¸ºç‰¹å¾æå–å™¨ï¼Œå¹¶ç»“åˆ **LoRA** ç­–ç•¥è¿›è¡Œé«˜æ•ˆå¾®è°ƒï¼Œåœ¨æ€§èƒ½ä¸è®­ç»ƒæ•ˆç‡ä¹‹é—´å–å¾—è‰¯å¥½å¹³è¡¡ã€‚  
- **âš–ï¸ åŒé‡å†³ç­–æœºåˆ¶**ï¼šåŸºäºé‡å»ºç‰¹å¾å›¾çš„ **Perplexityï¼ˆå›°æƒ‘åº¦ï¼‰** ä¸ **Residualï¼ˆæ®‹å·®ï¼‰** è¿›è¡Œè”åˆåˆ¤å®šï¼Œå®ç°ç¨³å®šä¸”é«˜ç²¾åº¦çš„æ£€æµ‹ã€‚

---

## ğŸ“ˆ æ€§èƒ½è¡¨ç°ï¼ˆPerformance Comparisonï¼‰

MIRROR åœ¨ **14 ä¸ªä¸»æµ AIGI åŸºå‡†æ•°æ®é›†** ä¸Šå‡å±•ç°å‡ºå“è¶Šçš„æ£€æµ‹èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯åœ¨é«˜éš¾åº¦çš„ **In-the-Wildï¼ˆçœŸå®é‡å¤–ï¼‰** åœºæ™¯ä¸­ï¼Œç›¸æ¯”ç°æœ‰æœ€å…ˆè¿›æ–¹æ³•ï¼ˆSOTAï¼‰å–å¾—äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚

ä¸‹è¡¨ç»™å‡ºäº† MIRRORï¼ˆåŸºäºä¸åŒ DINO Backboneï¼‰ä¸å½“å‰ä¸»æµæ–¹æ³•ï¼ˆå¦‚ **DDAã€B-Freeã€UnivFD** ç­‰ï¼‰çš„ **å¹³è¡¡å‡†ç¡®ç‡ï¼ˆBalanced Accuracy, B.Accï¼‰** å¯¹æ¯”ç»“æœï¼š

### ä¸åŒ Backbone ä¸‹çš„ Benchmark å¯¹æ¯”ï¼ˆBalanced Accuracy, %ï¼‰

| ç±»åˆ« | Benchmark | SOTA åŸºçº¿ (B.Acc) | DINOv2-L | DINOv3-L | **DINOv3-H+ï¼ˆæœ€å¼ºï¼‰** | ç›¸å¯¹ SOTA æå‡ |
|---------|-----------|-------------------|----------|----------|---------------------------|----------------|
| **æ ‡å‡†åŸºå‡†** | AIGCDetectBenchmark | 90.3 (DDA) | 92.1 | 93.2 | **97.3** | **+3.7** |
| | GenImage | 88.9 (DDA) | 93.4 | 95.1 | **99.8** | **+7.8** |
| | UnivFakeDetect | 87.8 (DDA) | 95.6 | 97.4 | **92.4** | **+10.8** |
| | Synthbuster | 91.8 (DDA) | 92.6 | 93.3 | **99.2** | **+2.2** |
| | EvalGEN | 90.4 (DDA) | 91.9 | 92.8 | **99.8** | **+3.5** |
| | DRCT-2M | 99.2 (DDA) | 98.7 | 98.9 | **93.0** | âˆ’0.2 |
| **é‡å¤–åœºæ™¯** | Chameleon | 83.5 (B-Free) | 87.4 | 89.1 | **94.6** | **+7.2** |
| | SynthWildx | 86.1 (DDA) | 88.9 | 90.2 | **95.1** | **+5.1** |
| | WildRF | 91.1 (DDA) | 93.2 | 94.6 | **97.8** | **+4.8** |
| | AIGIBench | 89.5 (DDA) | 92.1 | 93.6 | **94.9** | **+5.4** |
| | CO-SPY | 93.8 (DDA) | 95.2 | 96.4 | **97.4** | **+3.3** |
| | RR-Dataset | 72.5 (DDA) | 75.6 | 77.1 | **88.3** | **+6.4** |
| | BFree-Online | 84.3 (DDA) | 88.2 | 89.9 | **97.6** | **+6.9** |

**è¯´æ˜ï¼š**
- æ‰€æœ‰æ•°æ®é›†å‡å·² **æ ¼å¼å¯¹é½ï¼ˆPNG -> JPGï¼‰** å¤„ç†ã€‚  
- æ‰€æœ‰ç»“æœå‡ä»¥ **å¹³è¡¡å‡†ç¡®ç‡ï¼ˆBalanced Accuracy, %ï¼‰** æŠ¥å‘Šã€‚  
- MIRROR åœ¨ä¸‰ç§ Backbone ä¸‹è¿›è¡Œè¯„ä¼°ï¼š**DINOv2-Lã€DINOv3-Lã€DINOv3-H+**ã€‚  
- éšç€ Backbone èƒ½åŠ›å¢å¼ºï¼Œæ•´ä½“æ€§èƒ½ç¨³å®šæå‡ï¼›åŒæ—¶ MIRROR åœ¨ **é‡å¤–åœºæ™¯** ä¸­å§‹ç»ˆä¿æŒæ˜¾è‘—ä¼˜åŠ¿ï¼Œä½“ç°äº†è‰¯å¥½çš„æ³›åŒ–æ€§ä¸é²æ£’æ€§ã€‚

---

## ğŸ› ï¸ é¡¹ç›®è¿›åº¦

- [x] **æ¨ç†ä»£ç å¼€æº**ï¼šæä¾›å®Œæ•´æ¨ç†è„šæœ¬ä¸é…ç½®ã€‚  
- [x] **æ¨¡å‹æƒé‡å‘å¸ƒ**ï¼šæä¾›åŸºäº **DINOv3-H+** çš„æ¨ç†æƒé‡ã€‚  
- [ ] **è®­ç»ƒæµç¨‹å¼€æº**ï¼šè®­ç»ƒä»£ç ä»¥åŠå‰©ä½™æƒé‡å°†åœ¨åç»­ç‰ˆæœ¬å‘å¸ƒã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1ï¸âƒ£ ç¯å¢ƒé…ç½®

æ¨èä½¿ç”¨ **Python 3.10+**ã€‚

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/YourUsername/MIRROR.git
cd MIRROR

# å®‰è£…åŸºç¡€ä¾èµ–
pip install torch torchvision tqdm pillow numpy scikit-learn transformers peft


```

> **æ³¨æ„**ï¼šè¯·æ ¹æ®æ‚¨çš„æ˜¾å¡å‹å·ï¼Œä» [PyTorch å®˜ç½‘](https://pytorch.org) è·å–å¯¹åº”çš„ `torch` å®‰è£…æŒ‡ä»¤ã€‚

### 2ï¸âƒ£ æƒé‡å‡†å¤‡

è¯·ç¡®ä¿æ‚¨çš„ `weight` ç›®å½•ä¸‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ç»“æ„ï¼š

```text
weight/
â”œâ”€â”€ checkpoint-h-cur.pth  # Phase 2 è®­ç»ƒåçš„æ¨¡å‹æ£€æŸ¥ç‚¹
â”œâ”€â”€ mirror_phase1.pth     # Phase 1 çš„ Memory Bank æƒé‡
â””â”€â”€ dinov3-huge/          # æœ¬åœ° DINOv3 éª¨å¹²æ¨¡å‹æƒé‡ç›®å½•
     â”œâ”€â”€ config.json  # DINOv3-Huge é…ç½®æ–‡ä»¶
     â”œâ”€â”€ model.safetensors    # DINOv3-Huge é¢„è®­ç»ƒæƒé‡

```

### 3ï¸âƒ£ ä¸€é”®æ¨ç†

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨è¯„ä¼°æµç¨‹ï¼š

```powershell
python inference.py \
  --model_path "./weight/checkpoint-h-cur.pth" \
  --memory_path "./weight/mirror_phase1.pth" \
  --backbone_path "./weight/dinov3-huge" \
  --base_data_path "/path/to/your/dataset" \
  --benchmarks Chameleon \
  --batch_size 128 \
  --device cuda \
  --use_amp

```

### 4ï¸âƒ£ æ¨ç†æ•°æ®é›†ç»“æ„è¯´æ˜

MIRROR çš„æ¨ç†è„šæœ¬æ”¯æŒ **å¤šåŸºå‡†ï¼ˆBenchmarkï¼‰+ å¤šå­æ•°æ®é›†ï¼ˆSub-datasetï¼‰** çš„è‡ªåŠ¨è¯„ä¼°ã€‚  
---

#### ğŸ“ æ€»ä½“ç»“æ„

`--base_data_path` åº”æŒ‡å‘æ‰€æœ‰ Benchmark çš„**æ ¹ç›®å½•**ï¼Œå…¶ä¸‹æ¯ä¸ªå­æ–‡ä»¶å¤¹å¯¹åº”ä¸€ä¸ª Benchmarkï¼š

```text
base_data_path/
â”œâ”€â”€ AIGC_bm/                # AIGCDetectBenchmark
â”œâ”€â”€ UniversalFakeDetect/    # UnivFD
â”œâ”€â”€ synthbuster/            # Synthbuster
â”œâ”€â”€ GenEval-JPEG/           # EvalGEN
â”œâ”€â”€ Chameleon/              # Chameleon
â”‚   â””â”€â”€ test/
â”œâ”€â”€ WildRF/
â”‚   â””â”€â”€ test/
â”œâ”€â”€ synthwildx/
â”œâ”€â”€ AIGIBench/
â”œâ”€â”€ CO-SPY-In-the-Wild/
â”œâ”€â”€ drct/
â”œâ”€â”€ RRDataset/
â””â”€â”€ B-Free/

---

## âš™ï¸ å‚æ•°è¯¦æ

| å‚æ•°å | ç±»å‹ | æè¿° |
| --- | --- | --- |
| `--model_path` | `str` | æ¨¡å‹æ£€æŸ¥ç‚¹è·¯å¾„ï¼ˆ.pth æ–‡ä»¶ï¼‰ã€‚ |
| `--memory_path` | `str` | Memory Bank æƒé‡è·¯å¾„ã€‚ |
| `--backbone_path` | `str` | DINOv3 é¢„è®­ç»ƒæƒé‡å­˜æ”¾ç›®å½•ã€‚ |
| `--base_data_path` | `str` | æµ‹è¯•æ•°æ®é›†æ ¹ç›®å½•ï¼ˆéœ€åŒ…å«å­ benchmark æ–‡ä»¶å¤¹ï¼‰ã€‚ |
| `--benchmarks` | `list` | å¾…è¯„ä¼°çš„åŸºå‡†åˆ—è¡¨ï¼Œå¦‚ `Genimage` `UnivFD`ã€‚ |
| `--device` | `str` | è¿è¡Œè®¾å¤‡ï¼Œå¯é€‰ `cuda` æˆ– `cpu`ã€‚ |
---

## ğŸ“Š è¾“å‡ºç»“æœè¯´æ˜

æ¨ç†å®Œæˆåï¼Œç³»ç»Ÿå°†åœ¨ `--output_dir`ï¼ˆé»˜è®¤ `./results`ï¼‰ä¸‹ç”Ÿæˆè¯¦ç»†çš„ CSV æŠ¥å‘Šï¼Œå‘½åæ ¼å¼ä¸º `{benchmark}_{timestamp}.csv`ã€‚

**æ ¸å¿ƒè¯„ä¼°æŒ‡æ ‡åŒ…å«ï¼š**

* **Acc / Bal_Acc**: æ€»ä½“å‡†ç¡®ç‡ä¸å¹³è¡¡å‡†ç¡®ç‡ã€‚
* **Real_Acc / Fake_Acc**: é’ˆå¯¹çœŸå®ä¸ä¼ªé€ æ ·æœ¬çš„åˆ†é¡¹å‡†ç¡®ç‡ã€‚
---

## ğŸ“‚ ä»£ç ç»“æ„ç®€è¿°

* `inference.py`: **ä¸»å…¥å£**ã€‚å°è£…äº†æ•°æ®æµã€é¢„å¤„ç†ä¸ç»“æœæŒä¹…åŒ–ã€‚
* `models/mirror.py`: **æ¨¡å‹æ ¸å¿ƒ**ã€‚å®šä¹‰äº† DINO éª¨å¹²ã€Memory Bank ç»“æ„åŠ Dual-Branch æ£€æµ‹å¤´ã€‚

---

## ğŸ“§ è”ç³»ä¸è´¡çŒ®

* **åé¦ˆ**ï¼šæ¬¢è¿é€šè¿‡ [Issues](https://www.google.com/search?q=https://github.com/YourUsername/MIRROR/issues) æäº¤ Bug æˆ–æ”¹è¿›å»ºè®®ã€‚
* **è”ç³»**ï¼šruiqi.liu24@nlpr.ia.ac.cnã€‚

---




